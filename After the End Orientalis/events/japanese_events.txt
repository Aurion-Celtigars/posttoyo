namespace = jp

#Adaption of the ATE Japanese Obon Festival

#Obon Festival Event
character_event = {
	id = jp.1
	desc = EVTDESC_jp_1
	picture = GFX_east_asian_cities
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	hide_from = yes
	
	trigger = {
		has_character_flag = holding_obon_festival
	}
	
	option = {
		name = EVTOPTA_jp1
		any_vassal = {
			limit = {
				religion = ROOT
				age = 16
				prisoner = no
				war = no
				NOT = { trait = incapable }
			}
			character_event = { id = jp.1 days = 2 tooltip = EVTTOOLTIP_jp_1 }
		}
		hidden_tooltip = { character_event = { id = jp.4 days = 10 } }
		hidden_tooltip = { character_event = { id = jp.5 days = 11 } }
		hidden_tooltip = { character_event = { id = jp.6 days = 12 } }
	}
}

# Invitation Received
character_event = {
	id = jp.2
	desc = EVTDESC_jp_2
	picture = GFX_east_asian_cities
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes

	trigger = { NOT = { is_inaccessible_trigger = yes } }
	
	option = {
		name = EVTOPTA_jp_2
		ai_chance = {
			factor = 80
			modifier = {
				factor = 0
				NOT = {
					opinion = {
						who = ROOT
						value = -20
					}
				}
			}
		}
		custom_tooltip = { text = agape_feast_accepted }
		set_character_flag = attending_agape_feast
		set_character_flag = do_not_disturb
		hidden_tooltip = { character_event = { id = jp.4 days = 8 } }
		hidden_tooltip = { character_event = { id = jp.5 days = 9 } }
		hidden_tooltip = { character_event = { id = jp.8 days = 20 } } # Safety catch flag clearing
	}
	option = {
		name = EVTOPTB_jp_2
		ai_chance = {
			factor = 20
		}
		FROM = {
			opinion = {
				modifier = opinion_dislike
				who = ROOT
				years = 2
			}
		}
		custom_tooltip = { text = obon_festival_declined }
		hidden_tooltip = {
			FROM = { character_event = { id = jp.3 } }
		}
	}
}

# Invitation Refused
character_event = {
	id = jp.3
	desc = EVTDESC_jp_3
	picture = GFX_east_asian_cities
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_3
		opinion = {
			modifier = opinion_dislike
			who = FROM
			years = 2
		}
	}
}

#Bon Odori
character_event = {
	id = jp.4
	desc = EVTDESC_jp_4
	picture = GFX_performance_theater
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_4
		lose_weight_small_effect = yes
		random_list = {
			10 = {
				add_trait = musician
			}
			10 = {
				add_trait = gregarious
			}
			10 = {
				add_trait = stressed
			}
			10 = {
				add_trait = zealous
			}
		}

		piety = 50
	}
	option = {
		name = EVTOPTB_jp_4
		piety = 10
	}	
	
}

# Okuribi
character_event = {
	id = jp.5
	desc = EVTDESC_jp_5
	picture = GFX_performance_theater
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
		
	option = { 
		name = EVTOPTA_jp_5

		piety = 20
	}

}

# Obon Festival Ends (Host)
character_event = {
	id = jp.6
	desc = EVTDESC_jp_6
	picture = GFX_japanese_gossip
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_6
		any_vassal = {
			limit = { has_character_flag = attending_obon_festival }
			opinion = {
				modifier = opinion_enjoyed_feast
				who = ROOT
				years = 2
			}
		}
		hidden_tooltip = {
			any_vassal = {
				limit = { has_character_flag = attending_obon_festival }
				character_event = { id = jp.7 }
			}
		}
		add_character_modifier = {
			name = held_obon_festival_timer
			years = 3
			hidden = yes
		}
		prestige = 50
		piety = 100
		clr_character_flag = holding_obon_festival
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
	}
}

# Obon Festival Ends (Guest)
character_event = {
	id = jp.7
	desc = EVTDESC_jp_7
	picture = GFX_japanese_gossip
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_7
		clr_character_flag = attending_obon_festival
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
	}
}

# Safety catch - clears character flags and modifiers
character_event = {
	id = jp.8

	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
		clr_character_flag = holding_obon_festival
		clr_character_flag = attending_obon_festival
	}
}

#Hanami Festival Event
character_event = {
	id = jp.9
	desc = EVTDESC_jp_9
	picture = GFX_east_asian_cities
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	hide_from = yes
	
	trigger = {
		has_character_flag = holding_hanami_festival
	}
	
	option = {
		name = EVTOPTA_jp9
		hidden_tooltip = { character_event = { id = jp.10 days = 5 } }
		hidden_tooltip = { character_event = { id = jp.11 days = 6 } }
		hidden_tooltip = { character_event = { id = jp.12 days = 10 } }
	}
}

#Viewing the Cherry Blossoms
character_event = {
	id = jp.10
	desc = EVTDESC_jp_10
	picture = GFX_cherry_blossom
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_10
		lose_weight_small_effect = yes
		random_list = {
			10 = {
				add_trait = patient
			}
			10 = {
				add_trait = humble
			}
			10 = {
				add_trait = slothful
			}
			10 = {
				add_trait = content
			}
		}

		prestige = 50
	}
	option = {
		name = EVTOPTB_jp_10
		piety = 10
	}	
	
}

# Night Festival
character_event = {
	id = jp.11
	desc = EVTDESC_jp_11
	picture = GFX_cherry_blossom
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
		
	option = { 
		name = EVTOPTA_jp_11

		piety = 20
	}

}

# Hanami Festival Ends
character_event = {
	id = jp.12
	desc = EVTDESC_jp_12
	picture = GFX_mountain_calm
	border = GFX_event_normal_frame_religion
	
	hide_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_jp_12
		add_character_modifier = {
			name = held_hanami_festival_timer
			years = 3
			hidden = yes
		}
		prestige = 50
		piety = 100
		clr_character_flag = holding_hanami_festival
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
	}
}

# Safety catch - clears character flags and modifiers
character_event = {
	id = jp.13

	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = do_not_disturb
		clr_character_flag = recent_minor_decision
		clr_character_flag = holding_hanami_festival
	}
}
#Shinto Branch Trait Decision
character_event = {
	id = jp.25	
	desc = EVTDESC_jp25
	picture = GFX_evt_bishop_indian_group
	religion = shinto
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_alternate_start_parameter = { key = religion_names value = random }
		}
	}
	
	option = {
		name = EVTOPTA_shinto25
		hidden_tooltip = {
			remove_trait = bukka_shinto
			remove_trait = minzoku_shinto

		}
		add_trait = koshitsu_shinto
		ai_chance = {
			factor = 10
		}
	}

	option = {
		name = EVTOPTB_shinto25
		hidden_tooltip = {
			remove_trait = koshitsu_shinto
			remove_trait = bukka_shinto

		}
		add_trait = minzoku_shinto
		ai_chance = {
			factor = 10
		}
	}
	
	option = {
		name = EVTOPTC_shinto25
		hidden_tooltip = {
			remove_trait = koshitsu_shinto
			remove_trait = minzoku_shinto

		}
		add_trait = bukka_shinto
		ai_chance = {
			factor = 10
		}
	}
}